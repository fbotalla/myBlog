<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HomePage </title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>



    <script>
        $(document).ready(() =>{
            $('#sendRequest').click(() =>{
                var e = document.getElementById("projects");
                var id = e.options[e.selectedIndex].value;
                console.log(id);
               $.ajax({
                url:'account?project_id=' + id,
                type: 'POST',                  
                dataType: 'json',
                success: res => {
                    console.log(res.image);
                     $('#status').html('<br> Name:' + res.name +'<hr>' + 'Language: ' + res.languange 
                     + '<hr>' + res.description + '<hr>' + '<video controls autoplay><source src="../' + res.image +'" type ="video/mp4"></video><hr>'
                     )},
                    error: res=>{
                        $('#status').html('<hr>' +'Select a valid project from the dropdown'+'<hr>');
                    }         
               });

               $.ajax({
                   url:'getComments?project_id=' +id,
                   type: 'POST',
                   dataType: 'json',
                   success: res => {
                       if(res.length > 0){
                       var elements = $();
                       for(x = 0; x < res.length;x++){
                            elements = elements.add('<p>Comment #'+(x+1)+': '+res[x].comment+'</p><br>');
                       }
                       console.log(res);
                       $('#allComments').html("");
                       $('#allComments').append(elements);
                    }else{
                        $('#allComments').html("No comments yet! Add one!");
                    }
                   }
               })
            });

            $('#addComment').click(()=>{
            console.log("Wer are in")
            var e = document.getElementById("projects");
            var id = e.options[e.selectedIndex].value;
            console.log(id);
          
            var comment = document.getElementById("comments").value;
            console.log(comment);

            $('#allComments').append('<p>'+comment+'</p><br>');

            $.ajax({
                url:'addComment?project_id='+id+'&comment='+comment,
                type: 'POST',
                success :res =>{
                    console.log("Comment inserted");
                   
                }

            });
        });
     });
    </script>



<style>
    video{
        width: 500px;
        height: 500px;
    }
    body{
        background-color: rgb(201, 199, 199);
    }

    p:nth-of-type(odd) {
        color: blue;
    }
    p:nth-of-type(even) {
        color: red;
    }
</style>


</head>
<body>
<div class="col-md-offset-5"></div>
    <h1 class="col-md-2 col-md-offset-5">Blojects</h1>
    <h3 class="col-md-2 col-md-offset-5">(Blog of Projects)</h3>
</div>
<div class="col-md-2 col-md-offset-5">
    <form action="">
        <label for="projects">Select one to view</label>
        <select name="projects" id="projects"  class="form-control">

            <option value="0">Select a project </option>
            <option value="1">MathProof</option>
            <option value="2">BallTalla Academy</option>
            <option value="3">AJAX Registrations</option>
        </select>
    </form>
    <br><button id="sendRequest"  class="col-md-offset-5">submit</button>
   
</div>
    <div id="status" class="col-md-2 col-md-offset-5"></div>
    
    <div id="allComments" class="col-md-2 col-md-offset-5"></div>

<div class="col-md-2 col-md-offset-5">
  <form action="">
      <hr>
      <label for="comments">Please select a project and leave a comment </label>
      <textarea name="comments" id="comments" cols="30" rows="5"></textarea>
  </form>
  <br><button id="addComment"  class="col-md-offset-5">Comment</button>

</div>






</body>

</html>